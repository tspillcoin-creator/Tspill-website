<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TSPILL</title>
    <meta name="description" content="TSPILL — Presale on Solana. SOL settled at USDT value with on-chain claims at TGE." />
    <style>
      html{scroll-behavior:smooth}
      body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b0f14;color:#e8f0ff}
      header{position:sticky;top:0;background:#0b0f14;padding:16px 20px 10px;text-align:center;z-index:10;border-bottom:1px solid #121a2a}
      .nav{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin:8px 0}
      .btn{padding:8px 12px;border:1px solid #2a3550;border-radius:10px;color:#cfe3ff;text-decoration:none;background:#0e1420;cursor:pointer}
      main section{max-width:1000px;margin:40px auto;padding:0 20px}
      .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin:20px 0}
      .card{padding:16px;border:1px solid #1c2538;border-radius:14px;background:#0e1420}
      .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
      input[type="number"],input[type="text"]{width:100%;padding:10px;border-radius:10px;border:1px solid #1c2538;background:#0b1220;color:#e8f0ff}
      .muted{color:#9fb3d1;font-size:.95rem}
      .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
      .ok{color:#8ee5a1}.warn{color:#ffd57a}.err{color:#ffa7a7}
      /* Router: show one section at a time */
      main{max-width:1000px}
      main section{display:none}
      main[data-active="overview"]   #overview{display:block}
      main[data-active="tokenomics"] #tokenomics{display:block}
      main[data-active="whitepaper"] #whitepaper{display:block}
      main[data-active="roadmap"]    #roadmap{display:block}
      main[data-active="presale"]    #presale{display:block}
      main[data-active="community"]  #community{display:block}
      main[data-active="trust"]      #trust{display:block}
    </style>
  </head>
  <body>
    <header>
      <h1 style="margin:6px 0 6px">TSPILL</h1>
      <nav class="nav" aria-label="Primary">
        <a class="btn" href="#overview">Home</a>
        <a class="btn" href="#tokenomics">Tokenomics</a>
        <a class="btn" href="#whitepaper">Whitepaper</a>
        <a class="btn" href="#roadmap">Roadmap</a>
        <a class="btn" href="#presale">Presale</a>
        <a class="btn" href="#community">Community</a>
        <a class="btn" href="#trust">Trust</a>
      </nav>
      <div class="row" style="justify-content:center;margin-top:6px">
        <button id="connectBtn" class="btn">Connect Phantom</button>
        <span id="walletBadge" class="muted"></span>
      </div>
    </header>

    <main id="main" data-active="overview">
      <!-- HOME -->
      <section id="overview">
        <h2>Build with creators. Ship with manufacturers.</h2>
        <p class="muted">Mint: <span class="mono">2whGdeMMm1E8JJ6cANoNARLNFbayfV2Mixh3WSQUUSbK</span></p>
        <div class="grid" style="margin-top:16px">
          <div class="card">
            <strong>About</strong>
            <p style="margin:8px 0 0">TSPILL links creators and manufacturers to turn concepts into products with attribution, fair rewards, and transparent economics.</p>
          </div>
          <div class="card">
            <strong>Utility</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Access programs and open calls</li>
              <li>Participation incentives</li>
              <li>Program rails (fees/discounts)</li>
              <li>Signals for launches</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- TOKENOMICS -->
      <section id="tokenomics">
        <h3>Tokenomics</h3>
        <div class="grid">
          <div class="card">
            <strong>Supply</strong>
            <p style="margin:8px 0 0">Total supply: 1,000,000,000 TSPILL. Presale allocation: 30% (300,000,000). Presale vesting: 10% TGE, 90% over 9 months.</p>
          </div>
          <div class="card">
            <strong>Governance & locks</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Mint authority revoked</li>
              <li>Program references published pre‑TGE</li>
              <li>Treasury movements via dual control</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- WHITEPAPER -->
      <section id="whitepaper">
        <h3>Whitepaper</h3>
        <p><a class="btn" href="./TSPILL_Whitepaper.pdf" target="_blank" rel="noopener">View PDF</a></p>
      </section>

      <!-- ROADMAP -->
      <section id="roadmap">
        <h3>Roadmap</h3>
        <div class="grid">
          <div class="card">
            <strong>Presale‑01</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Site live; presale treasury open</li>
              <li>Public ledger updates</li>
              <li>Claim parameters published pre‑TGE</li>
            </ul>
          </div>
          <div class="card">
            <strong>Programs</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Open calls and prototype support</li>
              <li>Pilot runs with vetted partners</li>
              <li>Receipts for distributions</li>
            </ul>
          </div>
          <div class="card">
            <strong>Scale</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Recurring challenges</li>
              <li>Dashboards and emissions reviews</li>
              <li>Tooling integrations</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- PRESALE -->
      <section id="presale">
        <h3>Presale</h3>
        <p class="muted">Buy TSPILL on Solana — USDT value paid in SOL. 10% at TGE, then monthly over 9 months.</p>

        <div class="grid">
          <div class="card">
            <strong>Checkout</strong>
            <div class="row" style="margin-top:8px">
              <input id="usdtInput" type="number" step="0.01" min="5" placeholder="USDT value (e.g., 50)" />
              <button class="btn" data-q="50">50</button>
              <button class="btn" data-q="100">100</button>
              <button class="btn" data-q="250">250</button>
              <button class="btn" data-q="1000">1000</button>
            </div>
            <p class="muted" style="margin:8px 0 0">Min 5 • Max 1000 (USDT value)</p>

            <div id="estimateBlock" style="margin-top:12px">
              <label for="solOut">Estimated SOL to send</label>
              <input id="solOut" type="text" readonly />
              <p class="muted" id="quoteNote">Fetching quote…</p>
            </div>

            <div style="margin-top:12px">
              <label for="tspillOut">You receive (TSPILL)</label>
              <input id="tspillOut" type="text" readonly />
              <p class="muted">Price: 0.001 USDT per TSPILL</p>
            </div>

            <div style="margin-top:12px">
              <button id="sendBtn" class="btn">Send SOL to Presale</button>
              <p id="sendHint" class="muted">Phantom opens to review and sign a SOL transfer to the treasury.</p>
              <p id="txStatus" class="muted"></p>
            </div>
          </div>

          <div class="card">
            <strong>Key parameters</strong>
            <ul style="margin:8px 0 0 18px">
              <li>Allocation: 30% (300,000,000 TSPILL)</li>
              <li>Token price: 0.001 USDT per TSPILL</li>
              <li>Accepted currency: SOL (quoted at settlement)</li>
              <li>Per‑wallet cap: up to 1,000 USDT equivalent</li>
              <li>Soft/Hard caps: 50,000 / 300,000 USDT</li>
              <li>Window: 21 days (optional 7‑day extension)</li>
            </ul>
            <div style="margin-top:12px">
              <strong>Wallets & mint</strong>
              <p class="mono" style="margin:8px 0 0">Presale treasury (SOL): DgNqpvhNEhEKrc3wUKRccP1S2iUPFgaKbVqik7QmmYTK</p>
              <p class="mono" style="margin:6px 0 0">Admin (dev): BsBpUykVhosqpkQpwVbnoMLyFWT3RxFxiXgpG8kQWY8P</p>
              <p class="mono" style="margin:6px 0 0">TSPILL mint: 2whGdeMMm1E8JJ6cANoNARLNFbayfV2Mixh3WSQUUSbK</p>
            </div>
            <p class="muted" style="margin-top:10px">Use Phantom; do not send from exchange addresses. Quotes are live and valid briefly.</p>
          </div>
        </div>

        <div class="card">
          <strong>Positive roll‑forward</strong>
          <p style="margin:8px 0 0">If the soft cap is not reached by the end date, all confirmed allocations automatically roll into Presale‑02 at the same price and vesting terms.</p>
        </div>

        <div class="card">
          <strong>Transparency</strong>
          <ul style="margin:8px 0 0 18px">
            <li>Public read‑only ledger shows total raised (USDT value), allocations, and remaining capacity.</li>
            <li>Before TGE, claim parameters (Merkle root/stream) will be published for deterministic claims.</li>
            <li>No third‑party custody; funds remain in the presale treasury wallet.</li>
          </ul>
        </div>
      </section>

      <!-- COMMUNITY -->
      <section id="community">
        <h3>Community</h3>
        <p>Follow updates on X, Discord, and GitHub.</p>
      </section>

      <!-- TRUST -->
      <section id="trust">
        <h3>Trust</h3>
        <ul>
          <li>Mint authority revoked; update secured.</li>
          <li>Presale SOL‑settled at USDT value with on‑chain claims.</li>
        </ul>
      </section>
    </main>

    <footer style="text-align:center;padding:24px;color:#9fb3d1">© TSPILL</footer>

    <!-- Solana web3.js via CDN -->
    <script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js" crossorigin="anonymous"></script>

    <script>
      // Robust hash router so Home and all sections render on load + navigation. [Ref]
      (function(){
        const main=document.getElementById('main');
        const ids=new Set(['overview','tokenomics','whitepaper','roadmap','presale','community','trust']);
        function setActive(){
          let h=(location.hash||'#overview').slice(1);
          if(!ids.has(h)) h='overview';
          main.setAttribute('data-active',h);
        }
        window.addEventListener('hashchange',setActive);
        window.addEventListener('DOMContentLoaded',setActive);
      })();
    </script>

    <script>
      // Phantom connect + dual-source SOL/USDT quote + SOL transfer. [Refs]
      (function(){
        const RPC="https://api.mainnet-beta.solana.com";
        const connection=new solanaWeb3.Connection(RPC,'confirmed');

        const treasury=new solanaWeb3.PublicKey("DgNqpvhNEhEKrc3wUKRccP1S2iUPFgaKbVqik7QmmYTK");
        const PRICE_USDT_PER_TSPILL=0.001;
        const MIN_USDT=5, MAX_USDT=1000;

        const connectBtn=document.getElementById('connectBtn');
        const walletBadge=document.getElementById('walletBadge');
        const usdtInput=document.getElementById('usdtInput');
        const solOut=document.getElementById('solOut');
        const tspillOut=document.getElementById('tspillOut');
        const quoteNote=document.getElementById('quoteNote');
        const estimateBlock=document.getElementById('estimateBlock');
        const sendBtn=document.getElementById('sendBtn');
        const txStatus=document.getElementById('txStatus');
        const quickBtns=document.querySelectorAll('button[data-q]');

        let provider=null;
        let quote={solPerUsdt:0, ts:0};

        function getProvider(){ if('solana' in window){ const p=window.solana; if(p && p.isPhantom) return p; } return null; }

        async function connect(){
          provider=getProvider();
          if(!provider){ walletBadge.textContent="Phantom not found — install the wallet."; return; }
          try{
            const r=await provider.connect();
            walletBadge.textContent="Connected: "+r.publicKey.toBase58().slice(0,4)+"…"+r.publicKey.toBase58().slice(-4);
          }catch(e){ walletBadge.textContent="Connect cancelled."; }
        }
        connectBtn.addEventListener('click',connect);
        quickBtns.forEach(b=>b.addEventListener('click',()=>{ usdtInput.value=b.getAttribute('data-q'); recalc(); }));

        // Primary: Jupiter Price API v6 • Fallback: CoinGecko simple price. [Refs]
        async function fetchFromJupiter(){
          const r=await fetch("https://price.jup.ag/v6/price?ids=SOL");
          const j=await r.json();
          if(!j?.data?.SOL?.price) throw new Error("No Jupiter price");
          const solUsd=j.data.SOL.price; // USD per SOL
          return 1/solUsd; // USDT≈USD per 1 USDT -> SOL
        }
        async function fetchFromCoingecko(){
          const r=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd");
          const j=await r.json();
          const solUsd=j?.solana?.usd;
          if(!solUsd) throw new Error("No CoinGecko price");
          return 1/solUsd;
        }
        async function fetchQuote(){
          try{
            const v=await fetchFromJupiter(); quote.solPerUsdt=v; quote.ts=Date.now();
            quoteNote.textContent="Quote: 1 USDT ≈ "+v.toFixed(9)+" SOL • updated just now";
            estimateBlock.style.display='';
          }catch(_){
            try{
              const v=await fetchFromCoingecko(); quote.solPerUsdt=v; quote.ts=Date.now();
              quoteNote.textContent="Quote (fallback): 1 USDT ≈ "+v.toFixed(9)+" SOL";
              estimateBlock.style.display='';
            }catch(e2){
              quoteNote.textContent="Quote unavailable. Proceed without estimate or retry.";
              estimateBlock.style.display='none';
            }
          }
        }
        setInterval(()=>{ if(document.getElementById('presale').offsetParent!==null){ fetchQuote(); } }, 30000);

        async function recalc(){
          const usdt=parseFloat(usdtInput.value||"0");
          if(!isFinite(usdt) || usdt<=0){ solOut.value=""; tspillOut.value=""; return; }
          if(!quote.ts || Date.now()-quote.ts>30_000){ await fetchQuote(); }
          if(quote.solPerUsdt && estimateBlock.style.display!=='none'){
            const solAmt=usdt*quote.solPerUsdt; solOut.value=solAmt.toFixed(6)+" SOL";
          }
          const tspill=usdt/PRICE_USDT_PER_TSPILL;
          tspillOut.value=Math.floor(tspill).toLocaleString()+" TSPILL";
        }
        usdtInput.addEventListener('input',recalc);
        fetchQuote();

        async function sendSol(){
          txStatus.textContent="";
          const usdt=parseFloat(usdtInput.value||"0");
          if(!provider){ await connect(); if(!provider) return; }
          if(!isFinite(usdt) || usdt<MIN_USDT || usdt>MAX_USDT){
            txStatus.innerHTML="<span class='warn'>Enter between "+MIN_USDT+" and "+MAX_USDT+" USDT (equivalent).</span>";
            return;
          }
          if(!quote.ts || Date.now()-quote.ts>30_000){ await fetchQuote(); }
          if(!quote.solPerUsdt){ txStatus.innerHTML="<span class='warn'>Proceeding without estimate.</span>"; }
          const solAmount=(quote.solPerUsdt? usdt*quote.solPerUsdt : 0);
          const lamports=Math.max(1, Math.round(solAmount*solanaWeb3.LAMPORTS_PER_SOL)); // avoid 0 lamports

          try{
            const fromPubkey=provider.publicKey;
            const tx=new solanaWeb3.Transaction().add(
              solanaWeb3.SystemProgram.transfer({ fromPubkey, toPubkey: treasury, lamports })
            );
            tx.feePayer=fromPubkey;
            const { blockhash, lastValidBlockHeight }=await connection.getLatestBlockhash();
            tx.recentBlockhash=blockhash;

            const signed=await provider.signTransaction(tx);
            const sig=await connection.sendRawTransaction(signed.serialize(), { skipPreflight:false });
            await connection.confirmTransaction({ signature:sig, blockhash, lastValidBlockHeight }, 'confirmed');

            const tspill=Math.floor(usdt/PRICE_USDT_PER_TSPILL);
            txStatus.innerHTML="<span class='ok'>Sent.</span> Tx: <span class='mono'>"+sig+"</span><br/>"+
              "Record — Wallet: <span class='mono'>"+fromPubkey.toBase58()+"</span> • USDT value: "+usdt.toFixed(2)+
              " • SOL: "+(lamports/solanaWeb3.LAMPORTS_PER_SOL).toFixed(6)+
              " • TSPILL: "+tspill.toLocaleString()+".";
          }catch(e){
            txStatus.innerHTML="<span class='err'>Transaction failed or cancelled.</span>";
          }
        }
        document.getElementById('sendBtn').addEventListener('click',sendSol);
      })();
    </script>
  </body>
</html>
